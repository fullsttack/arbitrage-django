سوکت های والکس
مقدمه
در دنیای پرتغییر بازارهای مالی، دسترسی به اطلاعات لحظه‌ای یکی از عوامل حیاتی موفقیت است.
سوکت های والکس به عنوان یک راهکار حرفه‌ای و به‌روز، امکان دریافت داده‌های real-time از بازار رمزارزها را فراهم می‌کنند و جایگزینی قدرتمند برای مدل‌های سنتی درخواست/پاسخ مبتنی بر REST هستند.

بر خلاف APIهای REST که نیازمند ارسال مکرر درخواست برای دریافت داده‌های جدید هستند، سوکت ها با ایجاد یک اتصال پایدار و دوطرفه، اطلاعات را به محض وقوع تغییرات در بازار برای شما ارسال می‌کنند. این معماری باعث کاهش چشمگیر تاخیر (latency)، مصرف منابع، و بار شبکه می‌شود و تجربه‌ای سریع، سبک و روان را فراهم می‌سازد.

مزیت‌های کلیدی سوکت های والکس
✅ دریافت آنی و بدون وقفه اطلاعات بازار، مناسب برای الگوریتم‌های ترید و تحلیل‌های حساس به زمان
✅ کاهش مصرف منابع سرور و کلاینت نسبت به REST API
✅ پایداری اتصال در بلندمدت، بدون نیاز به ارسال مجدد درخواست
✅ پشتیبانی از کانال‌های متنوع مانند عمق بازار، معاملات، قیمت‌ها و...
عملکرد پایدار و بدون قطعی
زیرساخت سوکت والکس به گونه‌ای طراحی شده است که اتصال شما را تا حد امکان پایدار نگه دارد.

مناسب چه کسانی است؟
سوکت والکس برای گروه‌های زیر توصیه می‌شود:

توسعه‌دهندگان ربات‌های ترید خودکار (Auto-Trading Bots)
سازندگان داشبوردهای تحلیلی Real Time
ارائه‌دهندگان API واسط و سرویس‌های بازار داده
محدودیت‌ها
به منظور ارائه خدمات بهتر به کاربران والکس محدودیت هایی برای کانکشن به وب سوکت در نظر گرفته شده است. این محدودیت ها به شرح زیر میباشد:

قطع کانکشن کاربران به وب سوکت پس از مدت سی دقیقه
در هر channel حداکثر میتوانند پنجاه message ارسال کنید
از طرف سرور هر بیست ثانیه PING ارسال میشود و در صورتی که کاربران PONG ارسال کنند ، سی ثایه به مدت زمان اتصال کانکشن شما اضافه میشود.
دقت داشته باشید حداکثر میتوانید صد PONG ارسال کنید
در ادامه این مستند، نحوه اتصال، لیست کانال‌های موجود، و نمونه‌کدهایی در زبان‌های مختلف برای استفاده از این قابلیت قدرتمند ارائه شده است.


دریافت عمق بازار خرید (buyDepth)
از طریق این کانال می‌توانید سفارش‌های خرید موجود در Order Book یک بازار خاص را به‌صورت لحظه‌ای دریافت کنید.
این داده‌ها برای نمایش لیست سفارش‌های خرید، تحلیل عمق بازار، و طراحی ابزارهای معاملاتی بسیار کاربردی هستند.

آدرس اتصال WebSocket
برای اتصال باید از آدرس زیر استفاده کنید.



wss://api.wallex.ir/ws
فرمت پیام Subscribe
برای دریافت عمق بازار باید پیام خود را با فرمت زیر ارسال کنید و میتوانید هر مارکتی را جایگزین MARKET قرار دهید



["subscribe", { "channel": "MARKET@buyDepth" }]
مثال



["subscribe", { "channel": "َUSDTTMN@buyDepth" }]
["subscribe", { "channel": "َBTCUSDT@buyDepth" }]
نمونه Response-Body
پس از ارسال پیام در سوکت ، فرمت جواب هایی که دریافت میکنید به‌صورت زیر میباشد که هر آبجکت بیانگر یک اوردر در اوردربوک میباشد.

فیلد	توضیحات
quantity	مقدار سفارش
price	قیمت هر واحد
sum	مجموع مقدار سفارش


  [
    "USDTTMN@buyDepth",
    [
      { "quantity": 255.75, "price": 82131, "sum": 21005003.25 },
      { "quantity": 103.07, "price": 82083, "sum": 8460294.81 },
      { "quantity": 139.05, "price": 82066, "sum": 11411277.3 }
    ]
  ]
نمونه کد در زبان های مختلف
JavaScript
Python
GOLang
cURL (websocat)


  import websocket
  import json

  def on_message(ws, message):
      print("Received:", message)

  def on_open(ws):
      subscribe = ["subscribe", { "channel": "USDTTMN@buyDepth" }]
      ws.send(json.dumps(subscribe))

  ws = websocket.WebSocketApp(
      "wss://api.wallex.ir/ws",
      on_open=on_open,
      on_message=on_message
  )

  ws.run_forever()
      



دریافت عمق بازار فروش (sellDepth)
از طریق این کانال می‌توانید سفارش‌های فروش موجود در Order Book یک بازار خاص را به‌صورت لحظه‌ای دریافت کنید.
این داده‌ها برای نمایش لیست سفارش‌های فروش ، تحلیل عمق بازار، و طراحی ابزارهای معاملاتی بسیار کاربردی هستند.

آدرس اتصال WebSocket
برای اتصال باید از آدرس زیر استفاده کنید



wss://api.wallex.ir/ws
فرمت پیام Subscribe
برای دریافت عمق بازار باید پیام خود را با فرمت زیر ارسال کنید و میتوانید هر مارکتی را جایگزین MARKET قرار دهید



["subscribe", { "channel": "MARKET@sellDepth" }]
مثال



["subscribe", { "channel": "َUSDTTMN@sellDepth" }]
["subscribe", { "channel": "َBTCUSDT@sellDepth" }]
نمونه Response-Body
پس از ارسال پیام در سوکت ، فرمت جواب هایی که دریافت میکنید به‌صورت زیر میباشد که هر آبجکت بیانگر یک اوردر در اوردربوک میباشد.

فیلد	توضیحات
quantity	مقدار سفارش
price	قیمت هر واحد
sum	مجموع مقدار سفارش


  [
    "USDTTMN@sellbuyDepth",
    [
      { "quantity": 255.75, "price": 82131, "sum": 21005003.25 },
      { "quantity": 103.07, "price": 82083, "sum": 8460294.81 },
      { "quantity": 139.05, "price": 82066, "sum": 11411277.3 }
      
    ]
  ]
نمونه کد در زبان های مختلف
JavaScript
Python
GOLang
cURL (websocat)


  import websocket
  import json

  def on_message(ws, message):
      print("Received:", message)

  def on_open(ws):
      subscribe = ["subscribe", { "channel": "USDTTMN@sellDepth" }]
      ws.send(json.dumps(subscribe))

  ws = websocket.WebSocketApp(
      "wss://api.wallex.ir/ws",
      on_open=on_open,
      on_message=on_message
  )

  ws.run_forever()
      
