
درباره سوکت های والکس
سوکت های والکس
مقدمه
در دنیای پرتغییر بازارهای مالی، دسترسی به اطلاعات لحظه‌ای یکی از عوامل حیاتی موفقیت است.
سوکت های والکس به عنوان یک راهکار حرفه‌ای و به‌روز، امکان دریافت داده‌های real-time از بازار رمزارزها را فراهم می‌کنند و جایگزینی قدرتمند برای مدل‌های سنتی درخواست/پاسخ مبتنی بر REST هستند.

بر خلاف APIهای REST که نیازمند ارسال مکرر درخواست برای دریافت داده‌های جدید هستند، سوکت ها با ایجاد یک اتصال پایدار و دوطرفه، اطلاعات را به محض وقوع تغییرات در بازار برای شما ارسال می‌کنند. این معماری باعث کاهش چشمگیر تاخیر (latency)، مصرف منابع، و بار شبکه می‌شود و تجربه‌ای سریع، سبک و روان را فراهم می‌سازد.

مزیت‌های کلیدی سوکت های والکس
✅ دریافت آنی و بدون وقفه اطلاعات بازار، مناسب برای الگوریتم‌های ترید و تحلیل‌های حساس به زمان
✅ کاهش مصرف منابع سرور و کلاینت نسبت به REST API
✅ پایداری اتصال در بلندمدت، بدون نیاز به ارسال مجدد درخواست
✅ پشتیبانی از کانال‌های متنوع مانند عمق بازار، معاملات، قیمت‌ها و...
عملکرد پایدار و بدون قطعی
زیرساخت سوکت والکس به گونه‌ای طراحی شده است که اتصال شما را تا حد امکان پایدار نگه دارد.

مناسب چه کسانی است؟
سوکت والکس برای گروه‌های زیر توصیه می‌شود:

توسعه‌دهندگان ربات‌های ترید خودکار (Auto-Trading Bots)
سازندگان داشبوردهای تحلیلی Real Time
ارائه‌دهندگان API واسط و سرویس‌های بازار داده
محدودیت‌ها
به منظور ارائه خدمات بهتر به کاربران والکس محدودیت هایی برای کانکشن به وب سوکت در نظر گرفته شده است. این محدودیت ها به شرح زیر میباشد:

قطع کانکشن کاربران به وب سوکت پس از مدت سی دقیقه
در هر channel حداکثر میتوانند پنجاه message ارسال کنید
از طرف سرور هر بیست ثانیه PING ارسال میشود و در صورتی که کاربران PONG ارسال کنند ، سی ثایه به مدت زمان اتصال کانکشن شما اضافه میشود.
دقت داشته باشید حداکثر میتوانید صد PONG ارسال کنید
در ادامه این مستند، نحوه اتصال، لیست کانال‌های موجود، و نمونه‌کدهایی در زبان‌های مختلف برای استفاده از این قابلیت قدرتمند ارائه شده است.

وب سوکت
/
قیمت کوین
دریافت قیمت لحظه‌ای همه بازارها (all@price)
معرفی
کانال all@price برای دریافت قیمت لحظه‌ای تمام بازارهای فعال در والکس طراحی شده است. این کانال به‌صورت پیوسته، اطلاعات قیمتی جدید را برای مارکت‌هایی که قیمت آن‌ها تغییر کرده است ارسال می‌کند.

با استفاده از این کانال می‌توانید بدون نیاز به subscribe کردن به هر مارکت به‌صورت جداگانه، تغییرات قیمت همه بازارها را در لحظه دریافت کرده و آن‌ها را در جدول‌ها، داشبوردها یا ویجت‌های قیمت نمایش دهید.

آدرس اتصال WebSocket
برای اتصال باید از آدرس زیر استفاده کنید wss://api.wallex.ir/ws

فرمت پیام Subscribe
برای دریافت قیمت تمامی کوین ها باید پیام خود را در قالب زیر ارسال کنید



["subscribe", { "channel": "MARKET@trade" }]
نمونه پاسخ دریافتی
پس از ارسال پیام در سوکت ، جواب هایی که دریافت میکنید بصورت زیر میباشد .

فیلد	نوع	توضیح
symbol	string	نماد بازار (مانند BTCUSDT, PEPEUSDT)
price	String (decimal)	قیمت لحظه‌ای فعلی
24h_ch	Float	درصد تغییر قیمت در ۲۴ ساعت گذشته


[
    "all@price",
    {
        "symbol": "PEPEUSDT",
        "price": "0.00001136",
        "24h_ch": 1.15
    }
]
نمونه کد در زبان های مختلف
JavaScript
Python
GOLang
cURL (websocat)


  # نصب ابزار websocat (فقط یک بار)
  # https://github.com/vi/websocat

  # اتصال به سرور
  websocat wss://api.wallex.ir/ws

  # پس از اتصال، دستور زیر را در ترمینال وارد کنید:
  ["subscribe", {"channel": "USDTTMN@buyDepth"}]

  وب سوکت
/
ایونت های خصوصی کاربر
event های خصوصی کاربران
کانال‌های خصوصی WebSocket در والکس به کاربران احراز هویت‌شده اجازه می‌دهند تا تغییرات شخصی مربوط به حساب خود را به‌صورت لحظه ای دریافت کنند.
این event ها شامل به‌روزرسانی موجودی، وضعیت سفارش‌ها، و پیام‌های اطلاع‌رسانی هستند.

آدرس اتصال WebSocket
برای اتصال باید از آدرس زیر استفاده کنید



wss://api.wallex.ir/ws
فرمت پیام Subscribe
برای دریافت عمق بازار باید پیام خود را با فرمت زیر ارسال کنید و میتوانید هر مارکتی را جایگزین MARKET قرار دهید



["subscribe", { "channel": "STREAMKEY" }]
توجه داشته باشید در هنگام لاگین به والکس در مرحله ی آخر یک کلید به نام stream_key در پاسخ ای پی آی دریافت میکنید که باید جایگزین STREAMKEY قرار دهید

event های بروزرسانی موجودی کیف پول(balanceUpdated)
پس از هرگونه واریز ، برداشت ، یا ساخت سفارش و انجام معامله که در پی آن موجودی کیف پول شما آپدیت میشود ، شما یک ایونت دریافت میکنید

فیلد	نوع	توضیح
event	string	balanceUpdated
timestamp	timestamp	زمان بروزرسانی موجودی
price	String (decimal)	قیمت انجام معامله
asset	String	ارز اپدیت شده در کیف پول کاربر
value	String	مقدار موجود در کیف پول
locked	String	میزان دارایی فریز شده کاربر(زمان برداشت یا انجام یک معامله)


  [
    "STREAMKEY",
    {
      "event": "balanceUpdated",
      "timestamp": 1748773416376,
      "data": {
        "TMN": {
          "asset": "TMN",
          "faName": "تومان",
          "value": "16033085",
          "locked": "2507491"
        }
      }
    }
]
ثبت سفارش جدید یا بروزرسانی سفارش (orderSaved)
پس از ثبت سفارش جدید و یا بروزرسانی سفارش ها ، eventهایی که در خصوص آن دریافت میکنید به شرح زیر میباشد.

فیلد	نوع	توضیح
event	string	orderSaved
timestamp	timestamp	زمان بوجود آمدن اوردر جدید
price	String (decimal)	قیمت هر واحد
symbol	String	نام مارکت
side	String	BUY , SELL
origiQty	String	حجم سفارش
executedQty	String	مقدار معامله شده
status	String	NEW
active	Boolean	وضعیت فعال بودن سفارش گذاشته شده


  [
    "streamKey",
    {
      "event": "orderSaved",
      "timestamp": 1748773416414,
      "data": {
        "symbol": "USDTTMN",
        "side": "BUY",
        "clientOrderId": "LIMIT-xxxx",
        "price": "82102.0000000000000000",
        "origQty": "10.0000000000000000",
        "executedQty": "0.0000000000000000",
        "status": "NEW",
        "active": true
      }
    }
  ]
نمونه کد در زبان های مختلف
JavaScript
Python
GOLang
cURL (websocat)


  # نصب ابزار websocat (فقط یک بار)
  # https://github.com/vi/websocat

  # اتصال به سرور
  websocat wss://api.wallex.ir/ws

  # پس از اتصال، دستور زیر را در ترمینال وارد کنید:
  ["subscribe", {"channel": "STREAMKEY"}]